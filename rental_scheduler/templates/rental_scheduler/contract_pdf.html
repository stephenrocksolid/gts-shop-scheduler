{% load calculation_tags static humanize %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Contract #{{ contract.id }}</title>
    <link rel="stylesheet" href="{% static 'rental_scheduler/css/contract_pdf.min.css' %}">
</head>

<body>
    <div class="header">
        <div class="company-info">
            <div class="company-name">Gingerich Trailer Rental Ltd.</div>
            <div class="company-address">5815 State Route 39 | Millersburg, OH 44654</div>
            <div class="company-contact">Tel: 330-674-4441 | Fax: 330-674-4464</div>
        </div>

        <div class="contract-info">
            <div class="contract-title">RENTAL CONTRACT</div>
            <div class="contract-number">RC-{{ contract.id }}</div>
            <div class="contract-date">{{ contract.created_at|date:"F d, Y" }}</div>
        </div>
    </div>

    <div class="customer-info">
        <div class="info-grid">
            <div class="info-item">
                <span class="label">Name:</span>
                <span class="value">{{ contract.customer.name }}</span>
            </div>
            <div class="info-item">
                <span class="label">Phone:</span>
                <span class="value">{{ contract.customer.phone }}</span>
            </div>
            {% if contract.customer.drivers_license_number %}
            <div class="info-item">
                <span class="label">Driver's License:</span>
                <span class="value">{{ contract.customer.drivers_license_number }}</span>
            </div>
            {% endif %}
        </div>
        <div class="info-grid-bottom">
            <div class="info-item">
                <span class="label">Address:</span>
                <span class="value">
                    {% if contract.customer.street_address %}{{ contract.customer.street_address }}<br>{% endif %}
                    {% if contract.customer.city or contract.customer.state or contract.customer.zip_code %}
                    {% if contract.customer.city %}{{ contract.customer.city }}{% endif %}{% if contract.customer.city and contract.customer.state %}, {% endif %}{% if contract.customer.state %}{{ contract.customer.state }}{% endif %}{% if contract.customer.zip_code %} {{ contract.customer.zip_code }}{% endif %}
                    {% else %}
                    {% if not contract.customer.street_address %}&nbsp;{% endif %}
                    {% endif %}
                </span>
            </div>
            {% if contract.customer.po_number %}
            <div class="info-item">
                <span class="label">PO:</span>
                <span class="value">{{ contract.customer.po_number }}</span>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="trailer-info" style="margin-top: 0.5cm; border-top: 1px solid #666; padding-top: 0.5cm; border-radius: 0;">
        <div class="trailer-grid">
            <div class="info-item">
                <span class="label">Trailer:</span>
                <span class="value">{% if contract.trailer.width and contract.trailer.length %}{{ contract.trailer.length|floatformat:"-1" }}'x{{ contract.trailer.width|floatformat:"-1" }}' {{ contract.trailer.model }}{% else %}{{ contract.trailer.model }}{% endif %}</span>
            </div>
            <div class="info-item">
                <span class="label">Trailer #:</span>
                <span class="value">{{ contract.trailer.number }}</span>
            </div>
            <div class="info-item">
                <span class="label">Rate:</span>
                <span class="value">{{ contract|unit_rate|safe_currency }}</span>
            </div>
        </div>
        <div class="trailer-grid-dates" style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 0.3cm;">
            <div class="info-item">
                <span class="label">Hauling Capacity:</span>
                <span class="value">{% if contract.trailer.hauling_capacity %}{{ contract.trailer.hauling_capacity|floatformat:0|intcomma }} lbs{% else %}N/A{% endif %}</span>
            </div>
            <div class="info-item">
                <span class="label">Pickup Date & Time:</span>
                <span class="value">{{ contract.start_datetime|date:"m/d/Y g:i A" }}</span>
            </div>
            <div class="info-item">
                <span class="label">Return Date & Time:</span>
                <span class="value">{{ contract.end_datetime|date:"m/d/Y g:i A" }}</span>
            </div>
            <div class="info-item">
                <span class="label">Rental Duration:</span>
                <span class="value">{{ contract|display_duration }}</span>
            </div>
        </div>
    </div>

    <div class="checkbox-section">
        <div class="checkbox-grid">
            <div class="checkbox-column">
                <div class="checkbox-item">
                    <div class="checkbox {% if contract.is_picked_up %}checked{% endif %}"></div>
                    <span class="checkbox-label"> Picked Up</span>
                </div>
                <div class="checkbox-item">
                    <div class="checkbox {% if contract.is_returned %}checked{% endif %}"></div>
                    <span class="checkbox-label"> Returned</span>
                </div>
            </div>
            <div class="checkbox-column">
                <div class="checkbox-item">
                    <div class="checkbox {% if contract.payment_type == 'cash' %}checked{% endif %}"></div>
                    <span class="checkbox-label"> Cash</span>
                </div>
                <div class="checkbox-item">
                    <div class="checkbox {% if contract.payment_type == 'charge' %}checked{% endif %}"></div>
                    <span class="checkbox-label"> Charge</span>
                </div>
            </div>
            <div class="checkbox-column">
                <div class="checkbox-item">
                    <div class="checkbox {% if contract.is_billed %}checked{% endif %}"></div>
                    <span class="checkbox-label"> Billed</span>
                </div>
                <div class="checkbox-item">
                    <div class="checkbox {% if contract.is_invoiced %}checked{% endif %}"></div>
                    <span class="checkbox-label"> Send Invoice</span>
                </div>
            </div>
            <div class="checkbox-column">
                <div class="checkbox-column-heading">Payment</div>
                <div class="checkbox-item">
                    <div class="checkbox {% if contract.payment_timing == 'pickup' %}checked{% endif %}"></div>
                    <span class="checkbox-label"> On Pickup</span>
                </div>
                <div class="checkbox-item">
                    <div class="checkbox {% if contract.payment_timing == 'return' %}checked{% endif %}"></div>
                    <span class="checkbox-label"> On Return</span>
                </div>
            </div>
        </div>
    </div>

    <div class="terms-section">
        <h2>Terms and Conditions</h2>
        <ul>
            <li>Rental Price per day is for up to 400 miles. If mileage exceeds 400 miles you will be subject to additional charges.</li>
            <li>Customer is responsible for any Safety checks at hookup... Safety chains, Brakes, Brake Hookups, Lights, Tires, Air Pressure, Coupler, Lug Nuts, Door Latches, etc.</li>
            <li>Customer is responsible for any liabilities, damages, accidents, or theft, while trailer is in their rental period which includes trailers set outside gates for after hour pickup or returned after hours. If gates are open, always drop trailers off inside gates unless instructed to leave outside for another customer.</li>
            <li>INSPECTION - Customer acknowledges that he has had an opportunity to personally inspect the equipment, and finds it suitable for his needs and in good condition, and that he understands its proper use. Customer further acknowledges his duty to inspect the equipment prior to use and notify Dealer of any defects.</li>
            <li>A late fee will be charged on any late return.</li>
            <li>Customer agrees to be subject to a reasonable cleaning charge for equipment returned dirty.</li>
            <li>A cancellation fee will be charged on any canceled reservation unless it gets canceled the same day or agreement made with rental company.</li>
            <li>Trailers set outside to be picked up after hours are subject to an extra fee.</li>
            <li>Booking this trailer by phone and/or using electronic signatures, constitutes acceptance of these terms and conditions, same as signing below.</li>
            <li>Contract terms and conditions are in effect as long as Renter has possession of trailer.</li>
            <li>You hereby release us from all liability's, damages, injury or loss of time that may arise in connection with your use of this rental unit.</li>
        </ul>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; margin-top: 0.5cm;">
        <div class="payment-terms" style="font-size: 9px; text-align: center;">
            <p style="margin: 0;">All past-due accounts are subject to service charges.</p>
            <p style="margin: 0;">Balance Due 10th of following month.</p>
            <p style="margin: 0.3cm 0; font-weight: bold;">DO NOT PAY FROM THIS CONTRACT</p>

            <div class="signature-section" style="margin-top: 0.8cm;">
                <div style="display: flex; align-items: flex-end; justify-content: center;">
                    <div style="margin-right: 0.2cm; font-weight: bold; font-size: 11px;">X</div>
                    <div style="border-bottom: 1px solid #000; width: 80%;"></div>
                </div>
                <p style="margin: 0.1cm 0 0 0; font-style: italic; font-size: 9px;">I have read and agree to the terms printed above</p>
            </div>
        </div>

        <!-- Middle column for addon charges -->
        <div style="padding-left: 0.5cm;">
            <table style="width: 100%; font-size: 9px; border-collapse: collapse;">
                {% if contract.extra_mileage > 0 %}
                <tr>
                    <td style="text-align: right; padding: 0.08cm; font-weight: bold;">Extra Mileage</td>
                    <td style="width: 2.5cm; text-align: right; border: 0.5px solid #000; padding-right: 0.08cm;">{{ contract.extra_mileage|safe_currency }}</td>
                </tr>
                {% endif %}
                {% if contract.includes_winch %}
                <tr>
                    <td style="text-align: right; padding: 0.08cm; font-weight: bold;">Winch Fee</td>
                    <td style="width: 2.5cm; text-align: right; border: 0.5px solid #000; padding-right: 0.08cm;">{{ contract.winch_fee|safe_currency }}</td>
                </tr>
                {% endif %}
                {% if contract.includes_hitch_bar %}
                <tr>
                    <td style="text-align: right; padding: 0.08cm; font-weight: bold;">Hitch Bar Fee</td>
                    <td style="width: 2.5cm; text-align: right; border: 0.5px solid #000; padding-right: 0.08cm;">{{ contract.hitch_bar_fee|safe_currency }}</td>
                </tr>
                {% endif %}
                {% if contract.furniture_blanket_count > 0 %}
                <tr>
                    <td style="text-align: right; padding: 0.08cm; font-weight: bold;">Furniture Blankets ({{ contract.furniture_blanket_count }})</td>
                    <td style="width: 2.5cm; text-align: right; border: 0.5px solid #000; padding-right: 0.08cm;">{{ contract.furniture_blanket_fee|safe_currency }}</td>
                </tr>
                {% endif %}
                {% if contract.strap_chain_count > 0 %}
                <tr>
                    <td style="text-align: right; padding: 0.08cm; font-weight: bold;">Straps/Chains ({{ contract.strap_chain_count }})</td>
                    <td style="width: 2.5cm; text-align: right; border: 0.5px solid #000; padding-right: 0.08cm;">{{ contract.strap_chain_fee|safe_currency }}</td>
                </tr>
                {% endif %}
                {% if contract.has_evening_pickup %}
                <tr>
                    <td style="text-align: right; padding: 0.08cm; font-weight: bold;">Evening Pickup Fee</td>
                    <td style="width: 2.5cm; text-align: right; border: 0.5px solid #000; padding-right: 0.08cm;">{{ contract.evening_pickup_fee|safe_currency }}</td>
                </tr>
                {% endif %}
            </table>
        </div>

        <!-- Right column for main totals -->
        <div style="margin-left: auto; width: 7cm;">
            <table style="width: 100%; font-size: 9px; border-collapse: collapse;">
                <tr>
                    <td style="text-align: right; padding: 0.08cm; font-weight: bold;">Rate</td>
                    <td style="width: 2.8cm; text-align: right; border: 0.5px solid #000; padding-right: 0.08cm;">
                        {{ contract|unit_rate|safe_currency }}
                    </td>
                </tr>
                <tr>
                    <td style="text-align: right; padding: 0.08cm; font-weight: bold;">Subtotal</td>
                    <td style="width: 2.8cm; text-align: right; border: 0.5px solid #000; padding-right: 0.08cm;">{{ contract.subtotal|safe_currency }}</td>
                </tr>
                <tr>
                    <td style="text-align: right; padding: 0.08cm; font-weight: bold;">Tax</td>
                    <td style="width: 2.8cm; text-align: right; border: 0.5px solid #000; padding-right: 0.08cm;">{{ contract.tax_amount|safe_currency }}</td>
                </tr>
                <tr>
                    <td style="text-align: right; padding: 0.08cm; font-weight: bold;">Total</td>
                    <td style="width: 2.8cm; text-align: right; border: 0.5px solid #000; padding-right: 0.08cm;">{{ contract.total_amount|safe_currency }}</td>
                </tr>
                <tr>
                    <td style="text-align: right; padding: 0.08cm; font-weight: bold;">Booking Down Payment<br>(Non Refundable)</td>
                    <td style="width: 2.8cm; text-align: right; border: 0.5px solid #000; padding-right: 0.08cm;">{{ contract.down_payment|safe_currency }}</td>
                </tr>
                <tr>
                    <td style="text-align: right; padding: 0.08cm; font-weight: bold;">Balance Due</td>
                    <td style="width: 2.8cm; text-align: right; border: 0.5px solid #000; padding-right: 0.08cm;">{{ contract.balance_due|safe_currency }}</td>
                </tr>
            </table>
        </div>
    </div>
</body>

</html>