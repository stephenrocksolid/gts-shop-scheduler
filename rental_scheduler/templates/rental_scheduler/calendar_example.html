{% extends "base.html" %}
{% load static %}

{% block title %}Calendar Components Example{% endblock %}

{% block content %}
<!-- Page Header -->
{% include "rental_scheduler/components/page_header.html" with 
    page_title="Calendar Components" 
    page_subtitle="Demonstration of calendar templates and components"
    page_icon="<path fill-rule='evenodd' d='M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z' clip-rule='evenodd'/>"
    page_actions=True %}

{% block page_actions %}
    {% include "rental_scheduler/components/button.html" with 
        text="View Calendar" 
        variant="primary" 
        size="md"
        onclick="window.location.href='{% url 'rental_scheduler:calendar' %}'" %}
{% endblock %}

<!-- Calendar Legend Example -->
<div class="mb-8">
    <h3 class="text-lg font-medium text-gray-900 mb-4">Calendar Legend</h3>
    {% include "rental_scheduler/components/calendar_legend.html" with 
        calendars=example_calendars 
        status_choices=example_status_choices %}
</div>

<!-- Calendar Grid Example -->
<div class="mb-8">
    <h3 class="text-lg font-medium text-gray-900 mb-4">Calendar Grid</h3>
    {% include "rental_scheduler/components/calendar_grid.html" with 
        current_month_year="December 2024"
        day_headers=example_day_headers
        calendar_weeks=example_calendar_weeks %}
</div>

<!-- Job Chips Example -->
<div class="mb-8">
    <h3 class="text-lg font-medium text-gray-900 mb-4">Job Chips</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {% for job in example_jobs %}
        {% include "rental_scheduler/components/job_chip.html" with job=job %}
        {% endfor %}
    </div>
</div>

<!-- Day Cell Example -->
<div class="mb-8">
    <h3 class="text-lg font-medium text-gray-900 mb-4">Day Cells</h3>
    <div class="grid grid-cols-7 gap-2">
        {% for day in example_days %}
        {% include "rental_scheduler/components/day_cell.html" with day=day %}
        {% endfor %}
    </div>
</div>

<!-- Quick Actions Modal Example -->
<div class="mb-8">
    <h3 class="text-lg font-medium text-gray-900 mb-4">Quick Actions Modal</h3>
    {% include "rental_scheduler/components/button.html" with 
        text="Open Quick Actions" 
        variant="primary" 
        size="md"
        onclick="openQuickActionsExample()" %}
</div>

<!-- Status Update Modal Example -->
<div class="mb-8">
    <h3 class="text-lg font-medium text-gray-900 mb-4">Status Update Modal</h3>
    {% include "rental_scheduler/components/button.html" with 
        text="Update Job Status" 
        variant="secondary" 
        size="md"
        onclick="openStatusUpdateExample()" %}
</div>

<!-- Example Modals -->
<div id="example-quick-actions" x-data="quickActionsModal()">
    {% include "rental_scheduler/components/modal.html" with 
        modal_title="Quick Actions Example" 
        show_footer=True %}

    {% block modal_content %}
    <div class="quick-actions-content">
        <div class="job-info mb-4">
            <h4 class="text-lg font-medium text-gray-900 mb-2">Example Job Title</h4>
            <p class="text-sm text-gray-600">John Doe â€¢ 9:00 AM</p>
        </div>
        
        <div class="status-actions mb-4">
            <h5 class="text-sm font-medium text-gray-700 mb-2">Update Status</h5>
            <div class="grid grid-cols-2 gap-2">
                {% for status_value, status_display in example_status_choices %}
                <button class="status-action-btn status-{{ status_value|lower }}">
                    {% include "rental_scheduler/components/status_pill.html" with status=status_display %}
                </button>
                {% endfor %}
            </div>
        </div>
        
        <div class="action-buttons">
            <button class="action-btn edit-btn">
                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                </svg>
                Edit Job
            </button>
            <button class="action-btn view-btn">
                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"/>
                    <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"/>
                </svg>
                View Details
            </button>
        </div>
    </div>
    {% endblock %}

    {% block modal_footer %}
    {% include "rental_scheduler/components/button.html" with 
        text="Close" 
        variant="outline" 
        size="md"
        onclick="closeQuickActionsExample()" %}
    {% endblock %}
</div>

<div id="example-status-update" x-data="statusUpdateModal()">
    {% include "rental_scheduler/components/modal.html" with 
        modal_title="Status Update Example" 
        show_footer=True %}

    {% block modal_content %}
    <form class="status-update-form">
        <div class="form-group mb-4">
            <label for="example-status" class="form-label">New Status</label>
            <select id="example-status" name="status" class="form-input" required>
                {% for status_value, status_display in example_status_choices %}
                <option value="{{ status_value }}">{{ status_display }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-group mb-4">
            <label for="example-notes" class="form-label">Notes (Optional)</label>
            <textarea id="example-notes" name="notes" class="form-input" rows="3" 
                      placeholder="Add any notes about this status change..."></textarea>
        </div>
        
        <div class="form-group">
            <label class="form-label">
                <input type="checkbox" name="send_notification" class="mr-2">
                Send notification to customer
            </label>
        </div>
    </form>
    {% endblock %}

    {% block modal_footer %}
    {% include "rental_scheduler/components/button.html" with 
        text="Cancel" 
        variant="outline" 
        size="md"
        onclick="closeStatusUpdateExample()" %}
    {% include "rental_scheduler/components/button.html" with 
        text="Update Status" 
        variant="primary" 
        size="md"
        onclick="submitStatusUpdateExample()" %}
    {% endblock %}
</div>

<script>
// Example data for calendar components
document.addEventListener('DOMContentLoaded', function() {
    // Example calendars
    window.example_calendars = [
        { id: 1, name: 'Main Calendar', color: '#3B82F6' },
        { id: 2, name: 'Service Calendar', color: '#EF4444' },
        { id: 3, name: 'Delivery Calendar', color: '#10B981' }
    ];
    
    // Example status choices
    window.example_status_choices = [
        ['Scheduled', 'Scheduled'],
        ['InProgress', 'In Progress'],
        ['Completed', 'Completed'],
        ['Canceled', 'Canceled']
    ];
    
    // Example day headers
    window.example_day_headers = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    
    // Example calendar weeks (simplified for demo)
    window.example_calendar_weeks = [
        [
            { date: '2024-12-01', day_number: 1, is_today: false, is_other_month: true, events: [] },
            { date: '2024-12-02', day_number: 2, is_today: false, is_other_month: true, events: [] },
            { date: '2024-12-03', day_number: 3, is_today: false, is_other_month: false, events: [] },
            { date: '2024-12-04', day_number: 4, is_today: false, is_other_month: false, events: [] },
            { date: '2024-12-05', day_number: 5, is_today: false, is_other_month: false, events: [] },
            { date: '2024-12-06', day_number: 6, is_today: false, is_other_month: false, events: [] },
            { date: '2024-12-07', day_number: 7, is_today: false, is_other_month: false, events: [] }
        ]
    ];
    
    // Example jobs
    window.example_jobs = [
        {
            id: 1,
            title: 'Trailer Delivery',
            customer: 'John Doe',
            start_time: '09:00:00',
            status: 'Scheduled',
            is_completed: false,
            is_canceled: false,
            calendar: { color: '#3B82F6' }
        },
        {
            id: 2,
            title: 'Equipment Pickup',
            customer: 'Jane Smith',
            start_time: '14:30:00',
            status: 'InProgress',
            is_completed: false,
            is_canceled: false,
            calendar: { color: '#EF4444' }
        },
        {
            id: 3,
            title: 'Service Call',
            customer: 'Bob Johnson',
            start_time: '11:00:00',
            status: 'Completed',
            is_completed: true,
            is_canceled: false,
            calendar: { color: '#10B981' }
        }
    ];
    
    // Example days
    window.example_days = [
        {
            date: '2024-12-15',
            day_number: 15,
            is_today: true,
            is_other_month: false,
            is_weekend: false,
            event_count: 3,
            completed_count: 1,
            pending_count: 2,
            events: window.example_jobs
        },
        {
            date: '2024-12-16',
            day_number: 16,
            is_today: false,
            is_other_month: false,
            is_weekend: true,
            event_count: 1,
            completed_count: 0,
            pending_count: 1,
            events: [window.example_jobs[0]]
        }
    ];
});

// Modal functions for examples
function openQuickActionsExample() {
    document.getElementById('example-quick-actions').__x.$data.open();
}

function closeQuickActionsExample() {
    document.getElementById('example-quick-actions').__x.$data.close();
}

function openStatusUpdateExample() {
    document.getElementById('example-status-update').__x.$data.open();
}

function closeStatusUpdateExample() {
    document.getElementById('example-status-update').__x.$data.close();
}

function submitStatusUpdateExample() {
    if (window.layout && window.layout.showToast) {
        window.layout.showToast('Status updated successfully (example)', 'success');
    }
    closeStatusUpdateExample();
}
</script>
{% endblock %}


