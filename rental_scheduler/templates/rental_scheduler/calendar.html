{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link href="{% static 'rental_scheduler/css/calendar.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="calendar-container">
        <!-- Calendar Header -->
        <div class="calendar-header mb-6">
            <div class="flex justify-between items-center">
                <h2 class="text-2xl font-bold text-gray-900">Rental Calendar</h2>
                <a href="{% url 'rental_scheduler:contract_create' %}?next={% url 'rental_scheduler:home' %}" class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                    <svg class="-ml-1 mr-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                    </svg>
                    New Contract
                </a>
            </div>
        </div>

        <!-- Calendar Filters -->
        <div class="calendar-filters grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
            <!-- Category Filter -->
            <div class="flex justify-center">
                <div class="w-full">
                    <label for="category-filter" class="block text-sm font-medium text-gray-700">
                        Category
                    </label>
                    <div class="mt-1">
                        <select id="category-filter" class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-2 border-gray-300 rounded-md py-2.5">
                            <option value="">All Categories</option>
                            {% for category in categories %}
                            <option value="{{ category.id }}">{{ category.category }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>

            <!-- Trailer Filter -->
            <div class="flex justify-center">
                <div class="w-full">
                    <label for="trailer-filter" class="block text-sm font-medium text-gray-700">
                        Trailer
                    </label>
                    <div class="mt-1">
                        <select id="trailer-filter" class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-2 border-gray-300 rounded-md py-2.5 min-w-0" disabled>
                            <option value="">Select a category first</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Status Filter -->
            <div class="flex justify-center">
                <div class="w-full">
                    <label for="status-filter" class="block text-sm font-medium text-gray-700">
                        Status
                    </label>
                    <div class="mt-1">
                        <select id="status-filter" class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-2 border-gray-300 rounded-md py-2.5">
                            <option value="">All Statuses</option>
                            <option value="pending">Pending</option>
                            <option value="picked_up">Picked Up</option>
                            <option value="returned">Returned</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Legend and Instructions -->
        <div class="mb-6 flex justify-between items-center">
            <!-- Status Legend -->
            <div class="flex gap-6">
                <div class="flex items-center space-x-2">
                    <div class="w-4 h-4 bg-amber-700 rounded"></div>
                    <span class="text-sm text-gray-600">Pending</span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-4 h-4 bg-green-600 rounded"></div>
                    <span class="text-sm text-gray-600">Picked Up</span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-4 h-4 bg-blue-500 rounded"></div>
                    <span class="text-sm text-gray-600">Returned</span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-4 h-4 bg-fuchsia-600 rounded"></div>
                    <span class="text-sm text-gray-600">Overdue</span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-4 h-4 bg-red-600 rounded"></div>
                    <span class="text-sm text-gray-600">Service</span>
                </div>
            </div>

            <!-- Usage Instructions -->
            <div>
                <p class="text-sm text-gray-500">
                    <span class="font-medium">Single click</span> contracts to update status â€¢
                    <span class="font-medium">Double click</span> events to edit
                </p>
            </div>
        </div>

        <!-- Calendar Container -->
        <div id="calendar"></div>

        <!-- Loading State -->
        <div id="calendar-loading" class="calendar-loading hidden">
            <div class="calendar-loading-spinner"></div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'rental_scheduler/js/calendar.js' %}"></script>
{% endblock %}